<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VIBELAND - Pong Game</title>
    <link rel="stylesheet" type="text/css" href="../assets/styles.css">
    <style type="text/css">
        #pong {
            background: #000080;
            border: 2px inset #c0c0c0;
            cursor: crosshair;
        }
        
        .game-container {
            background-color: #ffffff;
            border: 2px inset #c0c0c0;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .score-display {
            background-color: #ffffff;
            border: 2px inset #c0c0c0;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-score {
            font-size: 24px;
            font-weight: bold;
            color: #000080;
            font-family: "Courier New", monospace;
        }
        
        .score-label {
            font-size: 14px;
            color: #000000;
            margin-bottom: 5px;
        }
    </style>
</head>

<body>
    <div class="container wide">
        <h1>VIBELAND PONG GAME</h1>
        
        <div class="score-display">
            <div>
                <div class="score-label">PLAYER</div>
                <div class="player-score" id="playerScore">0</div>
            </div>
            <div>
                <div class="score-label">COMPUTER</div>
                <div class="player-score" id="computerScore">0</div>
            </div>
        </div>
        
        <div class="game-container">
            <canvas id="pong" width="800" height="500"></canvas>
        </div>
        
        <div class="footer">
            <p><a href="../index.html" class="home-link">← Back to VIBELAND</a></p>
            <p>© 1999 VIBELAND - All Rights Reserved</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('pong');
        const ctx = canvas.getContext('2d');

        // Game Settings
        const PADDLE_WIDTH = 12;
        const PADDLE_HEIGHT = 90;
        const BALL_SIZE = 14;
        const PADDLE_SPEED = 5;
        const AI_SPEED = 4;
        const BALL_SPEED = 6;

        // Score variables
        let playerScore = 0;
        let computerScore = 0;

        // Paddle and Ball State
        let leftPaddle = {
            x: 0 + 10,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            width: PADDLE_WIDTH,
            height: PADDLE_HEIGHT
        };

        let rightPaddle = {
            x: canvas.width - PADDLE_WIDTH - 10,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            width: PADDLE_WIDTH,
            height: PADDLE_HEIGHT
        };

        let ball = {
            x: canvas.width / 2 - BALL_SIZE / 2,
            y: canvas.height / 2 - BALL_SIZE / 2,
            width: BALL_SIZE,
            height: BALL_SIZE,
            dx: BALL_SPEED * (Math.random() > 0.5 ? 1 : -1),
            dy: BALL_SPEED * ((Math.random() * 2 - 1) * 0.7)
        };

        // Update score display
        function updateScore() {
            document.getElementById('playerScore').textContent = playerScore;
            document.getElementById('computerScore').textContent = computerScore;
        }

        // Mouse Control for Left Paddle
        canvas.addEventListener('mousemove', function(e) {
            const rect = canvas.getBoundingClientRect();
            let mouseY = e.clientY - rect.top;
            leftPaddle.y = mouseY - PADDLE_HEIGHT / 2;
            // Clamp within bounds
            if (leftPaddle.y < 0) leftPaddle.y = 0;
            if (leftPaddle.y + PADDLE_HEIGHT > canvas.height)
                leftPaddle.y = canvas.height - PADDLE_HEIGHT;
        });

        // Draw Everything
        function drawRect(x, y, w, h, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x, y, w, h);
        }

        function drawBall(x, y, size, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x + size/2, y + size/2, size/2, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawNet() {
            ctx.strokeStyle = "#c0c0c0";
            ctx.lineWidth = 4;
            for (let i = 0; i < canvas.height; i += 36) {
                ctx.beginPath();
                ctx.moveTo(canvas.width/2, i);
                ctx.lineTo(canvas.width/2, i+18);
                ctx.stroke();
            }
        }

        // Collision
        function collide(p, b) {
            return (
                b.x < p.x + p.width &&
                b.x + b.width > p.x &&
                b.y < p.y + p.height &&
                b.y + b.height > p.y
            );
        }

        // Reset Ball
        function resetBall() {
            ball.x = canvas.width / 2 - BALL_SIZE / 2;
            ball.y = canvas.height / 2 - BALL_SIZE / 2;
            ball.dx = BALL_SPEED * (Math.random() > 0.5 ? 1 : -1);
            ball.dy = BALL_SPEED * ((Math.random() * 2 - 1) * 0.7);
        }

        // AI Movement
        function moveAIPaddle() {
            // Move towards the ball with some "slowness"
            let paddleCenter = rightPaddle.y + PADDLE_HEIGHT/2;
            if (ball.y + BALL_SIZE/2 < paddleCenter - 8) {
                rightPaddle.y -= AI_SPEED;
            } else if (ball.y + BALL_SIZE/2 > paddleCenter + 8) {
                rightPaddle.y += AI_SPEED;
            }
            // Clamp within bounds
            if (rightPaddle.y < 0) rightPaddle.y = 0;
            if (rightPaddle.y + PADDLE_HEIGHT > canvas.height)
                rightPaddle.y = canvas.height - PADDLE_HEIGHT;
        }

        // Main Game Loop
        function update() {
            // Move Ball
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Wall collision
            if (ball.y < 0) {
                ball.y = 0;
                ball.dy *= -1;
            }
            if (ball.y + BALL_SIZE > canvas.height) {
                ball.y = canvas.height - BALL_SIZE;
                ball.dy *= -1;
            }

            // Left paddle collision
            if (collide(leftPaddle, ball)) {
                ball.x = leftPaddle.x + leftPaddle.width + 1;
                ball.dx *= -1;
                // Add some "spin" based on where it hit
                let collidePoint = (ball.y + BALL_SIZE/2) - (leftPaddle.y + PADDLE_HEIGHT/2);
                ball.dy = collidePoint * 0.25;
            }

            // Right paddle collision
            if (collide(rightPaddle, ball)) {
                ball.x = rightPaddle.x - BALL_SIZE - 1;
                ball.dx *= -1;
                let collidePoint = (ball.y + BALL_SIZE/2) - (rightPaddle.y + PADDLE_HEIGHT/2);
                ball.dy = collidePoint * 0.25;
            }

            // Score (Ball out of bounds)
            if (ball.x < 0) {
                computerScore++;
                updateScore();
                resetBall();
            } else if (ball.x > canvas.width) {
                playerScore++;
                updateScore();
                resetBall();
            }

            // AI movement
            moveAIPaddle();
        }

        function render() {
            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw net
            drawNet();

            // Draw paddles and ball
            drawRect(leftPaddle.x, leftPaddle.y, leftPaddle.width, leftPaddle.height, '#c0c0c0');
            drawRect(rightPaddle.x, rightPaddle.y, rightPaddle.width, rightPaddle.height, '#c0c0c0');
            drawBall(ball.x, ball.y, BALL_SIZE, '#ffffff');
        }

        function gameLoop() {
            update();
            render();
            requestAnimationFrame(gameLoop);
        }

        // Initialize score display
        updateScore();
        gameLoop();
    </script>
</body>
</html>
